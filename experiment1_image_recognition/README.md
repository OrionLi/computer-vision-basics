# 实验一：图像识别

学生：李弢阳
学号：202211621213

本实验聚焦于使用 PyTorch 中的卷积神经网络（CNN）进行图像识别。目标是定义、训练并评估一个 CNN 模型，用于对 CIFAR - 10 数据集的图像进行分类。最终脚本还会保存训练好的模型，并展示一些示例预测结果。

## 目录结构
- `data/`：存储 CIFAR - 10 数据集（脚本会自动下载）。
- `models/`：存储保存的训练好的模型权重（例如，`simple_cnn_cifar10.pth`）。
- `src/`：包含实验的 Python 脚本。
  - `train.py`：一个整合的脚本，负责处理以下任务：
      - CIFAR - 10 数据集的加载、预处理和增强（若数据集不存在则自动下载）。
      - 定义 `SimpleCNN` 模型架构。
      - 在 CIFAR - 10 训练集上训练模型。
      - 在测试集上评估训练好的模型。
      - 保存训练好的模型权重。
      - 展示测试集中的一些示例预测结果，显示实际标签与预测标签。
      - 提供关于解释训练过程的说明。
- `README.md`：即本文件，提供实验的概述。

## 环境设置

### 安装 PyTorch
确保你已经安装了 PyTorch。如果没有安装，典型的安装命令如下：
```bash
pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu128
```
（注意：`cu128` 表示与 CUDA 12.8 兼容的版本。如果你使用的是仅支持 CPU 的环境或其他 CUDA 版本，请调整此命令。脚本会尝试使用 CUDA（如果可用），否则将回退到使用 CPU。）

如果你选择取消 `src/train.py` 中图像显示部分的注释，可能还需要安装 `matplotlib`：
```bash
pip3 install matplotlib numpy
```
（`numpy` 通常是 PyTorch 和数据处理的核心依赖项。）

## 运行实验一

1. **导航到实验目录**：
    打开终端并切换到 `experiment1_image_recognition` 目录。
    ```bash
    cd experiment1_image_recognition
    ```

2. **运行训练脚本**：
    使用 Python 执行 `train.py` 脚本：
    ```bash
    python src/train.py
    ```

    这一个命令将执行实验的所有步骤：
    * **数据准备**：初始化数据转换，并尝试将 CIFAR - 10 数据集下载/加载到 `data/` 目录中。
    * **模型初始化**：定义 `SimpleCNN` 模型，并为其在可用设备（CUDA 或 CPU）上进行训练做准备。
    * **训练**：对模型进行 `NUM_EPOCHS` 轮训练（默认值为 10，可以在脚本中修改）。训练进度（每 100 个小批量的损失、每个 epoch 的准确率）将打印到控制台。
    * **模型保存**：将训练好的模型的状态字典保存到 `models/simple_cnn_cifar10.pth`。
    * **评估**：在 CIFAR - 10 测试集上评估模型，并打印最终的测试准确率和平均损失。
    * **示例预测**：打印测试集中的一些示例预测结果，显示实际标签与预测标签。
    * **解释说明**：提供关于如何解释训练和评估指标的总结。

### 预期输出顺序
当你运行 `python src/train.py` 时，应该会看到以下内容：
1. 设备配置信息（例如，“使用设备：cuda”）。
2. 与 CIFAR - 10 数据集下载/加载相关的消息。
3. 训练进度：
    * 每个 epoch 中每 100 个小批量的损失更新。
    * 每个 epoch 结束时的整体训练准确率。
4. “训练完成。”消息。
5. 模型已保存的确认信息（例如，“模型已保存到 ../models/simple_cnn_cifar10.pth”）。
6. 测试集评估结果（准确率和平均损失）。
7. 包含示例预测结果的部分（例如，“图像 #1：实际：猫 | 预测：猫（正确）”）。
8. 关于解释训练过程的说明。

### 解释训练和评估指标（来自 `train.py` 的输出）

`train.py` 脚本会输出几个关键指标：
- **训练损失（每小批量和每个 epoch）**：损失值下降表明模型正在从训练数据中学习。
- **训练准确率（每个 epoch）**：显示模型对训练数据的拟合程度。
- **测试准确率（最后输出）**：这是一个关键指标，表明模型对新的、未见过的数据的泛化能力。如果训练准确率高而测试准确率低，可能表明存在过拟合问题。
- **平均测试损失**：与测试准确率类似，显示模型在未见过的数据上的性能。

理想情况下，训练和测试准确率都应该上升并最终稳定在较高值，而损失值（训练和测试）应该下降并稳定在较低值。这些指标有助于理解模型性能，并为超参数调整（如 `train.py` 中定义的 `LEARNING_RATE`、`NUM_EPOCHS`、`BATCH_SIZE`）或模型架构更改（在 `train.py` 中的 `SimpleCNN` 类中定义）提供决策依据。

### 注意事项
- **执行时间**：训练 CNN 可能需要一些时间，特别是在使用 CPU 或进行多轮训练时。为了快速测试，可以在 `src/train.py` 中减少 `NUM_EPOCHS`。
- **可调整参数**：关键参数（如学习率、训练轮数、批量大小和模型架构本身）都在 `src/train.py` 中定义，可以进行修改以进行实验。
- **使用 Matplotlib 显示图像**：脚本中包含了使用 Matplotlib 直观显示示例图像及其预测结果的注释代码。如果你想使用此功能，请确保已安装 Matplotlib，并且你所在的环境支持 GUI 弹出窗口。取消 `src/train.py` 中 `show_example_predictions_after_training` 函数内相关部分的注释。